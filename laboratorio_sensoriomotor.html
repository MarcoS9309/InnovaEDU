<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratorio Sensoriomotor - Identidades en Movimiento</title>
    <meta name="description" content="Experiencia multisensorial educativa que integra color, textura y movimiento para explorar identidades culturales diversas sin prejuicios">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #8B4A6B 0%, #D4A574 25%, #E8D5B7 50%, #9A8478 75%, #6B4E37 100%);
            background-size: 400% 400%;
            animation: gradientFlow 25s ease infinite;
            min-height: 100vh;
            overflow-x: hidden;
            color: #2C1810;
        }

        @keyframes gradientFlow {
            0%, 100% { background-position: 0% 50%; }
            25% { background-position: 100% 50%; }
            50% { background-position: 50% 100%; }
            75% { background-position: 0% 100%; }
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: rgba(248, 244, 236, 0.95);
            border-radius: 25px;
            padding: 40px 30px;
            margin-bottom: 40px;
            backdrop-filter: blur(15px);
            box-shadow: 0 20px 40px rgba(44, 24, 16, 0.15);
        }

        .header h1 {
            font-size: clamp(2.2em, 4vw, 3.5em);
            background: linear-gradient(45deg, #8B4A6B, #D4A574, #6B4E37);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 15px;
            font-weight: 700;
        }

        .header .subtitle {
            font-size: 1.3em;
            color: #5A4037;
            margin-bottom: 25px;
            line-height: 1.5;
        }

        .eca-badge {
            display: inline-block;
            background: linear-gradient(135deg, #8B4A6B, #A0566C);
            color: #E8D5B7;
            padding: 12px 25px;
            border-radius: 50px;
            font-weight: 600;
            font-size: 0.95em;
            box-shadow: 0 8px 20px rgba(139, 74, 107, 0.3);
        }

        .activity-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .activity-card {
            background: rgba(248, 244, 236, 0.95);
            border-radius: 20px;
            padding: 30px;
            backdrop-filter: blur(15px);
            box-shadow: 0 15px 35px rgba(44, 24, 16, 0.12);
            transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }

        .activity-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(139, 74, 107, 0.05), rgba(212, 165, 116, 0.1));
            opacity: 0;
            transition: opacity 0.4s ease;
        }

        .activity-card:hover::before {
            opacity: 1;
        }

        .activity-card:hover {
            transform: translateY(-8px);
            border-color: rgba(139, 74, 107, 0.3);
            box-shadow: 0 25px 50px rgba(44, 24, 16, 0.18);
        }

        .activity-title {
            font-size: 1.6em;
            color: #8B4A6B;
            margin-bottom: 15px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .activity-description {
            color: #5A4037;
            line-height: 1.7;
            margin-bottom: 20px;
            font-size: 1.05em;
        }

        .competency-list {
            background: rgba(139, 74, 107, 0.08);
            padding: 15px;
            border-radius: 12px;
            margin: 15px 0;
            border-left: 4px solid #8B4A6B;
        }

        .competency-list h4 {
            color: #8B4A6B;
            margin-bottom: 8px;
            font-size: 1em;
        }

        .competency-list ul {
            list-style: none;
            padding: 0;
        }

        .competency-list li {
            color: #5A4037;
            padding: 3px 0;
            font-size: 0.95em;
            position: relative;
            padding-left: 20px;
        }

        .competency-list li::before {
            content: '‚óè';
            color: #D4A574;
            position: absolute;
            left: 0;
        }

        .texture-canvas {
            width: 100%;
            height: 200px;
            background: #F8F4EC;
            border-radius: 15px;
            border: 3px solid #D4A574;
            cursor: crosshair;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 2px 10px rgba(0,0,0,0.1);
        }

        .color-palette {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
            margin: 20px 0;
        }

        .color-swatch {
            aspect-ratio: 1;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .color-swatch:hover {
            transform: scale(1.2);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }

        .color-swatch.active {
            border-color: #2C1810;
            transform: scale(1.1);
        }

        .texture-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            margin: 20px 0;
            justify-content: center;
        }

        .texture-btn {
            background: linear-gradient(135deg, #D4A574, #B8956A);
            color: #2C1810;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 5px 15px rgba(212, 165, 116, 0.3);
        }

        .texture-btn:hover {
            background: linear-gradient(135deg, #E8D5B7, #D4A574);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(212, 165, 116, 0.4);
        }

        .texture-btn.active {
            background: linear-gradient(135deg, #8B4A6B, #A0566C);
            color: #E8D5B7;
        }

        .identity-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 25px 0;
        }

        .identity-card {
            background: rgba(248, 244, 236, 0.8);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .identity-card:hover {
            border-color: #D4A574;
            background: rgba(248, 244, 236, 0.95);
            transform: translateY(-3px);
        }

        .identity-card.selected {
            border-color: #8B4A6B;
            background: rgba(139, 74, 107, 0.1);
        }

        .identity-icon {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: block;
        }

        .identity-name {
            font-weight: 600;
            color: #8B4A6B;
            margin-bottom: 5px;
        }

        .identity-description {
            font-size: 0.9em;
            color: #5A4037;
        }

        .movement-area {
            background: rgba(248, 244, 236, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            text-align: center;
            min-height: 300px;
            position: relative;
            overflow: hidden;
        }

        .movement-particles {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            pointer-events: none;
        }

        .reflection-area {
            background: linear-gradient(135deg, rgba(139, 74, 107, 0.1), rgba(212, 165, 116, 0.1));
            padding: 30px;
            border-radius: 20px;
            margin-top: 40px;
        }

        .reflection-area h3 {
            color: #8B4A6B;
            margin-bottom: 20px;
            text-align: center;
        }

        .reflection-input {
            width: 100%;
            min-height: 120px;
            padding: 20px;
            border: none;
            border-radius: 15px;
            background: rgba(248, 244, 236, 0.9);
            color: #2C1810;
            font-family: inherit;
            font-size: 1em;
            line-height: 1.6;
            resize: vertical;
        }

        .values-banner {
            background: linear-gradient(135deg, #8B4A6B, #6B4E37);
            color: #E8D5B7;
            padding: 25px;
            border-radius: 20px;
            margin: 40px 0;
            text-align: center;
        }

        .values-banner h3 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .values-list {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 15px;
        }

        .value-item {
            background: rgba(232, 213, 183, 0.2);
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 600;
        }

        @media (max-width: 768px) {
            .activity-grid {
                grid-template-columns: 1fr;
            }

            .color-palette {
                grid-template-columns: repeat(4, 1fr);
            }

            .identity-selector {
                grid-template-columns: repeat(2, 1fr);
            }

            .texture-controls {
                flex-direction: column;
                align-items: center;
            }

            .values-list {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>üé® Laboratorio Sensoriomotor</h1>
            <p class="subtitle">Explorando Identidades a Trav√©s del Color, la Textura y el Movimiento</p>
            <div class="eca-badge">Curr√≠culo ECA Ecuador - Educaci√≥n Cultural y Art√≠stica</div>
        </header>

        <div class="values-banner">
            <h3>üåà Valores Educativos Fundamentales</h3>
            <p>Celebramos la diversidad, respetamos cada identidad y construimos puentes de comprensi√≥n a trav√©s del arte</p>
            <div class="values-list">
                <div class="value-item">Respeto e Inclusi√≥n</div>
                <div class="value-item">Diversidad Cultural</div>
                <div class="value-item">Expresi√≥n Aut√©ntica</div>
                <div class="value-item">Aprendizaje Colaborativo</div>
                <div class="value-item">Creatividad Sin L√≠mites</div>
            </div>
        </div>

        <div class="activity-grid">
            <div class="activity-card">
                <h2 class="activity-title">üé≠ Explorador de Identidades</h2>
                <p class="activity-description">
                    Descubre y celebra diferentes identidades educativas y culturales. Cada una tiene su propia belleza, historia y valor √∫nico en nuestra comunidad.
                </p>
                
                <div class="competency-list">
                    <h4>Competencias ECA Desarrolladas:</h4>
                    <ul>
                        <li>Reconocimiento de la diversidad cultural</li>
                        <li>Desarrollo de la empat√≠a intercultural</li>
                        <li>Expresi√≥n de la identidad personal</li>
                        <li>Valoraci√≥n del patrimonio cultural</li>
                    </ul>
                </div>

                <div class="identity-selector">
                    <div class="identity-card" onclick="selectIdentity('escuela')">
                        <span class="identity-icon">üè´</span>
                        <div class="identity-name">Identidad Escolar</div>
                        <div class="identity-description">Espacios de aprendizaje formal, creatividad acad√©mica y crecimiento intelectual</div>
                    </div>
                    <div class="identity-card" onclick="selectIdentity('campo')">
                        <span class="identity-icon">üåæ</span>
                        <div class="identity-name">Identidad Rural</div>
                        <div class="identity-description">Conexi√≥n con la naturaleza, sabidur√≠a ancestral y vida comunitaria</div>
                    </div>
                    <div class="identity-card" onclick="selectIdentity('urbana')">
                        <span class="identity-icon">üèôÔ∏è</span>
                        <div class="identity-name">Identidad Urbana</div>
                        <div class="identity-description">Diversidad cultural, innovaci√≥n tecnol√≥gica y dinamismo social</div>
                    </div>
                    <div class="identity-card" onclick="selectIdentity('indigena')">
                        <span class="identity-icon">üèîÔ∏è</span>
                        <div class="identity-name">Identidad Ind√≠gena</div>
                        <div class="identity-description">Cosmovisi√≥n ancestral, respeto por la Pachamama y tradiciones milenarias</div>
                    </div>
                    <div class="identity-card" onclick="selectIdentity('costera')">
                        <span class="identity-icon">üåä</span>
                        <div class="identity-name">Identidad Costera</div>
                        <div class="identity-description">Vida mar√≠tima, tradiciones pesqueras y cultura afroecuatoriana</div>
                    </div>
                    <div class="identity-card" onclick="selectIdentity('amazonas')">
                        <span class="identity-icon">üå≥</span>
                        <div class="identity-name">Identidad Amaz√≥nica</div>
                        <div class="identity-description">Biodiversidad, culturas ancestrales y medicina tradicional</div>
                    </div>
                </div>
            </div>

            <div class="activity-card">
                <h2 class="activity-title">üåà Paleta de Emociones Culturales</h2>
                <p class="activity-description">
                    Cada identidad tiene sus colores √∫nicos. Explora c√≥mo diferentes culturas perciben y utilizan el color para expresar emociones, tradiciones y cosmovisiones.
                </p>

                <div class="competency-list">
                    <h4>Competencias ECA Desarrolladas:</h4>
                    <ul>
                        <li>Comprensi√≥n del simbolismo crom√°tico</li>
                        <li>Expresi√≥n art√≠stica multicultural</li>
                        <li>Desarrollo de la sensibilidad est√©tica</li>
                        <li>Comunicaci√≥n visual intercultural</li>
                    </ul>
                </div>

                <div class="color-palette" id="colorPalette">
                    <!-- Colores se generan din√°micamente -->
                </div>
                
                <p style="text-align: center; color: #5A4037; font-style: italic; margin: 15px 0;">
                    Selecciona colores y observa c√≥mo representan diferentes aspectos culturales
                </p>
            </div>

            <div class="activity-card">
                <h2 class="activity-title">ü§≤ Laboratorio de Texturas Virtuales</h2>
                <p class="activity-description">
                    Experimenta con texturas digitales que representan diferentes elementos culturales: desde la suavidad de los textiles andinos hasta la rugosidad de la corteza amaz√≥nica.
                </p>

                <div class="competency-list">
                    <h4>Competencias ECA Desarrolladas:</h4>
                    <ul>
                        <li>Exploraci√≥n sensorial digital</li>
                        <li>Apreciaci√≥n de materiales culturales</li>
                        <li>Desarrollo de la percepci√≥n t√°ctil</li>
                        <li>Creatividad art√≠stica experimental</li>
                    </ul>
                </div>

                <canvas class="texture-canvas" id="textureCanvas" 
                        onmousedown="startDrawing(event)" 
                        onmousemove="draw(event)" 
                        onmouseup="stopDrawing()" 
                        ontouchstart="startDrawing(event)" 
                        ontouchmove="draw(event)" 
                        ontouchend="stopDrawing()">
                </canvas>

                <div class="texture-controls">
                    <button class="texture-btn" onclick="changeTexture('suave', this)">Textil Andino</button>
                    <button class="texture-btn" onclick="changeTexture('rugoso', this)">Corteza Amaz√≥nica</button>
                    <button class="texture-btn" onclick="changeTexture('arena', this)">Arena Costera</button>
                    <button class="texture-btn" onclick="changeTexture('liso', this)">Cer√°mica Shuar</button>
                    <button class="texture-btn" onclick="clearCanvas()">Limpiar Lienzo</button>
                </div>
            </div>

            <div class="activity-card">
                <h2 class="activity-title">üíÉ Movimiento y Expresi√≥n Cultural</h2>
                <p class="activity-description">
                    El movimiento es un lenguaje universal. Explora c√≥mo diferentes culturas expresan alegr√≠a, celebraci√≥n, ritual y conexi√≥n espiritual a trav√©s del movimiento corporal.
                </p>

                <div class="competency-list">
                    <h4>Competencias ECA Desarrolladas:</h4>
                    <ul>
                        <li>Expresi√≥n corporal intercultural</li>
                        <li>Coordinaci√≥n y ritmo cultural</li>
                        <li>Comunicaci√≥n no verbal</li>
                        <li>Apreciaci√≥n de danzas tradicionales</li>
                    </ul>
                </div>

                <div class="movement-area" id="movementArea">
                    <h3>Mueve tu cursor o toca la pantalla para crear movimientos culturales</h3>
                    <p style="color: #5A4037; margin: 20px 0;">
                        Cada movimiento genera part√≠culas de colores que representan diferentes manifestaciones culturales ecuatorianas
                    </p>
                </div>

                <div style="text-align: center; margin: 20px 0;">
                    <button class="texture-btn" onclick="changeMovementStyle('ritual', this)">Danza Ritual</button>
                    <button class="texture-btn" onclick="changeMovementStyle('celebracion', this)">Celebraci√≥n</button>
                    <button class="texture-btn" onclick="changeMovementStyle('meditacion', this)">Movimiento Meditativo</button>
                </div>
            </div>
        </div>

        <div class="reflection-area">
            <h3>ü§î Espacio de Reflexi√≥n Intercultural</h3>
            <p style="text-align: center; color: #5A4037; margin-bottom: 20px;">
                Comparte tus reflexiones sobre la experiencia. ¬øQu√© has descubierto sobre las diferentes identidades? ¬øC√≥mo pueden coexistir y enriquecerse mutuamente?
            </p>
            <textarea 
                class="reflection-input" 
                placeholder="Escribe aqu√≠ tus reflexiones sobre la diversidad cultural, lo que has aprendido sobre diferentes identidades y c√≥mo podemos construir una sociedad m√°s inclusiva y respetuosa..."
                id="reflectionText">
            </textarea>
            <div style="text-align: center; margin-top: 20px;">
                <button class="texture-btn" onclick="saveReflection()">üíæ Guardar Reflexi√≥n</button>
                <button class="texture-btn" onclick="shareReflection()">üåç Compartir con la Comunidad</button>
            </div>
        </div>
    </div>

    <script>
        // Variables globales
        let currentIdentity = null;
        let currentColor = '#8B4A6B';
        let currentTexture = 'suave';
        let isDrawing = false;
        let movementStyle = 'ritual';
        
        // Inicializaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            initializeColorPalette();
            initializeCanvas();
            initializeMovementArea();
        });

        // Paletas de colores culturales
        const culturalColors = {
            escuela: ['#4A90E2', '#50C878', '#FFD700', '#FF6B6B', '#9B59B6', '#F39C12', '#E74C3C', '#2ECC71'],
            campo: ['#8FBC8F', '#DEB887', '#D2691E', '#CD853F', '#A0522D', '#6B8E23', '#F4E4BC', '#228B22'],
            urbana: ['#696969', '#FF4500', '#4169E1', '#FFD700', '#DC143C', '#00CED1', '#9370DB', '#FF1493'],
            indigena: ['#CD853F', '#DAA520', '#B22222', '#228B22', '#4682B4', '#8B4513', '#FF8C00', '#9ACD32'],
            costera: ['#00CED1', '#FF7F50', '#FFE4B5', '#F0E68C', '#20B2AA', '#87CEEB', '#F5DEB3', '#48D1CC'],
            amazonas: ['#228B22', '#8FBC8F', '#CD853F', '#DAA520', '#FF8C00', '#32CD32', '#6B8E23', '#9ACD32']
        };

        function initializeColorPalette() {
            const palette = document.getElementById('colorPalette');
            const defaultColors = culturalColors.escuela;
            
            defaultColors.forEach((color, index) => {
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch';
                swatch.style.backgroundColor = color;
                swatch.setAttribute('aria-label', `Seleccionar color ${color}`);
                swatch.setAttribute('role', 'button');
                swatch.setAttribute('tabindex', '0');
                swatch.onclick = () => selectColor(color, swatch);
                swatch.onkeydown = (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        selectColor(color, swatch);
                    }
                };
                if (index === 0) {
                    swatch.classList.add('active');
                    currentColor = color;
                }
                palette.appendChild(swatch);
            });
        }

        function selectColor(color, element) {
            document.querySelectorAll('.color-swatch').forEach(s => s.classList.remove('active'));
            element.classList.add('active');
            currentColor = color;
        }

        function selectIdentity(identity) {
            // Actualizar selecci√≥n visual
            document.querySelectorAll('.identity-card').forEach(card => card.classList.remove('selected'));
            event.currentTarget.classList.add('selected');
            
            currentIdentity = identity;
            
            // Actualizar paleta de colores
            updateColorPalette(identity);
            
            // Mostrar mensaje de identidad seleccionada
            showIdentityMessage(identity);
        }

        function updateColorPalette(identity) {
            const palette = document.getElementById('colorPalette');
            palette.innerHTML = '';
            
            const colors = culturalColors[identity] || culturalColors.escuela;
            
            colors.forEach((color, index) => {
                const swatch = document.createElement('div');
                swatch.className = 'color-swatch';
                swatch.style.backgroundColor = color;
                swatch.setAttribute('aria-label', `Seleccionar color ${color}`);
                swatch.setAttribute('role', 'button');
                swatch.setAttribute('tabindex', '0');
                swatch.onclick = () => selectColor(color, swatch);
                swatch.onkeydown = (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        selectColor(color, swatch);
                    }
                };
                if (index === 0) {
                    swatch.classList.add('active');
                    currentColor = color;
                }
                palette.appendChild(swatch);
            });
        }

        function showIdentityMessage(identity) {
            const messages = {
                escuela: "Has seleccionado la identidad escolar. Colores que inspiran aprendizaje, creatividad y crecimiento acad√©mico.",
                campo: "Has seleccionado la identidad rural. Colores que conectan con la tierra, la naturaleza y las tradiciones ancestrales.",
                urbana: "Has seleccionado la identidad urbana. Colores que reflejan la diversidad, la innovaci√≥n y el dinamismo de la ciudad.",
                indigena: "Has seleccionado la identidad ind√≠gena. Colores sagrados que representan la cosmovisi√≥n ancestral y la conexi√≥n espiritual.",
                costera: "Has seleccionado la identidad costera. Colores del mar, el sol y la rica cultura afroecuatoriana.",
                amazonas: "Has seleccionado la identidad amaz√≥nica. Colores de la selva, la biodiversidad y las culturas ancestrales."
            };
            
            // Crear notificaci√≥n temporal
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: linear-gradient(135deg, #8B4A6B, #D4A574);
                color: #E8D5B7;
                padding: 20px;
                border-radius: 15px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 1000;
                max-width: 300px;
                animation: slideInRight 0.5s ease;
            `;
            notification.textContent = messages[identity];
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideOutRight 0.5s ease';
                setTimeout(() => document.body.removeChild(notification), 500);
            }, 4000);
        }

        // Canvas para texturas
        function initializeCanvas() {
            const canvas = document.getElementById('textureCanvas');
            if (!canvas) {
                console.warn('Canvas element not found');
                return;
            }
            
            const ctx = canvas.getContext('2d');
            if (!ctx) {
                console.warn('Canvas context not available');
                return;
            }
            
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // Fondo inicial
            ctx.fillStyle = '#F8F4EC';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        function startDrawing(e) {
            isDrawing = true;
            draw(e);
        }

        function draw(e) {
            if (!isDrawing) return;
            
            const canvas = document.getElementById('textureCanvas');
            const ctx = canvas.getContext('2d');
            const rect = canvas.getBoundingClientRect();
            
            let x, y;
            if (e.touches) {
                x = e.touches[0].clientX - rect.left;
                y = e.touches[0].clientY - rect.top;
            } else {
                x = e.clientX - rect.left;
                y = e.clientY - rect.top;
            }
            
            ctx.globalCompositeOperation = 'source-over';
            ctx.fillStyle = currentColor;
            
            // Diferentes efectos seg√∫n la textura
            switch(currentTexture) {
                case 'suave':
                    ctx.globalAlpha = 0.3;
                    ctx.beginPath();
                    ctx.arc(x, y, 15, 0, 2 * Math.PI);
                    ctx.fill();
                    break;
                case 'rugoso':
                    ctx.globalAlpha = 0.8;
                    for(let i = 0; i < 5; i++) {
                        ctx.beginPath();
                        ctx.arc(x + Math.random() * 10 - 5, y + Math.random() * 10 - 5, 3, 0, 2 * Math.PI);
                        ctx.fill();
                    }
                    break;
                case 'arena':
                    ctx.globalAlpha = 0.5;
                    for(let i = 0; i < 8; i++) {
                        ctx.beginPath();
                        ctx.arc(x + Math.random() * 20 - 10, y + Math.random() * 20 - 10, 1, 0, 2 * Math.PI);
                        ctx.fill();
                    }
                    break;
                case 'liso':
                    ctx.globalAlpha = 0.7;
                    ctx.beginPath();
                    ctx.arc(x, y, 10, 0, 2 * Math.PI);
                    ctx.fill();
                    break;
            }
            
            ctx.globalAlpha = 1;
        }

        function stopDrawing() {
            isDrawing = false;
        }

        function changeTexture(texture, element) {
            currentTexture = texture;
            document.querySelectorAll('.texture-btn').forEach(btn => btn.classList.remove('active'));
            if (element) {
                element.classList.add('active');
            }
        }

        function clearCanvas() {
            const canvas = document.getElementById('textureCanvas');
            if (!canvas) {
                console.warn('Canvas element not found');
                return;
            }
            
            const ctx = canvas.getContext('2d');
            if (!ctx) {
                console.warn('Canvas context not available');
                return;
            }
            
            ctx.fillStyle = '#F8F4EC';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
        }

        // √Årea de movimiento
        function initializeMovementArea() {
            const area = document.getElementById('movementArea');
            
            area.addEventListener('mousemove', createMovementParticle);
            area.addEventListener('touchmove', createMovementParticle);
        }

        function createMovementParticle(e) {
            const area = document.getElementById('movementArea');
            const rect = area.getBoundingClientRect();
            
            let x, y;
            if (e.touches) {
                x = e.touches[0].clientX - rect.left;
                y = e.touches[0].clientY - rect.top;
                e.preventDefault();
            } else {
                x = e.clientX - rect.left;
                y = e.clientY - rect.top;
            }
            
            const particle = document.createElement('div');
            particle.className = 'movement-particles';
            
            // Colores seg√∫n el estilo de movimiento
            const colors = {
                ritual: ['#8B4A6B', '#D4A574', '#6B4E37'],
                celebracion: ['#FF6B6B', '#FFD700', '#FF8C00'],
                meditacion: ['#4682B4', '#87CEEB', '#E6E6FA']
            };
            
            const colorSet = colors[movementStyle];
            particle.style.backgroundColor = colorSet[Math.floor(Math.random() * colorSet.length)];
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.animation = 'particleFade 2s ease-out forwards';
            
            area.appendChild(particle);
            
            setTimeout(() => {
                if (particle.parentNode) particle.parentNode.removeChild(particle);
            }, 2000);
        }

        function changeMovementStyle(style, element) {
            movementStyle = style;
            document.querySelectorAll('.texture-btn').forEach(btn => btn.classList.remove('active'));
            if (element) {
                element.classList.add('active');
            }
        }

        // Funciones de reflexi√≥n
        function saveReflection() {
            const textElement = document.getElementById('reflectionText');
            if (!textElement) {
                showNotification('Error: No se pudo acceder al √°rea de texto', 'warning');
                return;
            }
            
            const text = textElement.value;
            if (text.trim()) {
                try {
                    localStorage.setItem('sensoriomotor_reflection', text);
                    showNotification('Reflexi√≥n guardada exitosamente', 'success');
                } catch (error) {
                    showNotification('Error al guardar la reflexi√≥n. Intenta de nuevo.', 'warning');
                }
            } else {
                showNotification('Por favor, escribe tu reflexi√≥n antes de guardar', 'warning');
            }
        }

        function shareReflection() {
            const textElement = document.getElementById('reflectionText');
            if (!textElement) {
                showNotification('Error: No se pudo acceder al √°rea de texto', 'warning');
                return;
            }
            
            const text = textElement.value;
            if (text.trim()) {
                showNotification('Funcionalidad de compartir en desarrollo. ¬°Gracias por tu reflexi√≥n!', 'info');
            } else {
                showNotification('Por favor, escribe tu reflexi√≥n antes de compartir', 'warning');
            }
        }

        function showNotification(message, type = 'info') {
            const colors = {
                success: 'linear-gradient(135deg, #28a745, #20c997)',
                warning: 'linear-gradient(135deg, #ffc107, #fd7e14)',
                info: 'linear-gradient(135deg, #17a2b8, #6f42c1)'
            };
            
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 50px;
                left: 50%;
                transform: translateX(-50%);
                background: ${colors[type]};
                color: white;
                padding: 15px 25px;
                border-radius: 25px;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                z-index: 1000;
                font-weight: 600;
                animation: bounceIn 0.5s ease;
            `;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'bounceOut 0.5s ease';
                setTimeout(() => document.body.removeChild(notification), 500);
            }, 3000);
        }

        // A√±adir estilos de animaci√≥n din√°micamente
        const style = document.createElement('style');
        style.textContent = `
            @keyframes particleFade {
                0% { opacity: 1; transform: scale(1); }
                100% { opacity: 0; transform: scale(0) translateY(-50px); }
            }
            
            @keyframes slideInRight {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
            
            @keyframes slideOutRight {
                from { transform: translateX(0); opacity: 1; }
                to { transform: translateX(100%); opacity: 0; }
            }
            
            @keyframes bounceIn {
                0% { transform: translateX(-50%) scale(0.3); opacity: 0; }
                50% { transform: translateX(-50%) scale(1.05); opacity: 0.8; }
                70% { transform: translateX(-50%) scale(0.9); opacity: 0.9; }
                100% { transform: translateX(-50%) scale(1); opacity: 1; }
            }
            
            @keyframes bounceOut {
                0% { transform: translateX(-50%) scale(1); opacity: 1; }
                100% { transform: translateX(-50%) scale(0.3); opacity: 0; }
            }
        `;
        document.head.appendChild(style);

        // Cargar reflexi√≥n guardada
        window.addEventListener('load', function() {
            try {
                const savedReflection = localStorage.getItem('sensoriomotor_reflection');
                const reflectionElement = document.getElementById('reflectionText');
                
                if (savedReflection && reflectionElement) {
                    reflectionElement.value = savedReflection;
                }
            } catch (error) {
                // Error silenciado para no interrumpir la experiencia del usuario
                console.warn('No se pudo cargar la reflexi√≥n guardada:', error);
            }
        });
    </script>
</body>
</html>